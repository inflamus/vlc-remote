!function(t){"use strict";t.module("VLCRemote",["ngTouch","pascalprecht.translate"]).config(["$compileProvider",function(t){t.debugInfoEnabled(!1)}]).config(["$locationProvider",function(t){t.html5Mode({enabled:!0,requireBase:!1})}]).config(["$translateProvider",function(t){t.useStaticFilesLoader({prefix:"js/locales/",suffix:".json"}).registerAvailableLanguageKeys(["af","am","ar","as","az","ba","be","bg","bn","bo","br","bs","ca","co","cs","cy","da","de","ds","dv","el","en","es","et","eu","fa","fi","fo","fr","fy","ga","gd","gl","gs","gu","ha","he","hi","hr","hs","hu","hy","id","ig","ii","is","it","iu","ja","ka","kk","kl","km","kn","ko","ky","lb","lo","lt","lv","mi","mk","ml","mn","mo","mr","ms","mt","nb","ne","nl","nn","ns","oc","or","pa","pl","pr","ps","pt","qu","rm","ro","ru","rw","sa","se","si","sk","sl","sm","sq","sr","sv","sw","sy","ta","te","tg","th","tk","tn","tr","tt","tz","ug","uk","ur","uz","vi","wo","xh","yo","zh","zu"],{"af_*":"af","am_*":"am","ar_*":"ar","as_*":"as","az_*":"az","ba_*":"ba","be_*":"be","bg_*":"bg","bn_*":"bn","bo_*":"bo","br_*":"br","bs_*":"bs","ca_*":"ca","co_*":"co","cs_*":"cs","cy_*":"cy","da_*":"da","de_*":"de","ds_*":"ds","dv_*":"dv","el_*":"el","en_*":"en","es_*":"es","et_*":"et","eu_*":"eu","fa_*":"fa","fi_*":"fi","fo_*":"fo","fr_*":"fr","fy_*":"fy","ga_*":"ga","gd_*":"gd","gl_*":"gl","gs_*":"gs","gu_*":"gu","ha_*":"ha","he_*":"he","hi_*":"hi","hr_*":"hr","hs_*":"hs","hu_*":"hu","hy_*":"hy","id_*":"id","ig_*":"ig","ii_*":"ii","is_*":"is","it_*":"it","iu_*":"iu","ja_*":"ja","ka_*":"ka","kk_*":"kk","kl_*":"kl","km_*":"km","kn_*":"kn","ko_*":"ko","ky_*":"ky","lb_*":"lb","lo_*":"lo","lt_*":"lt","lv_*":"lv","mi_*":"mi","mk_*":"mk","ml_*":"ml","mn_*":"mn","mo_*":"mo","mr_*":"mr","ms_*":"ms","mt_*":"mt","nb_*":"nb","ne_*":"ne","nl_*":"nl","nn_*":"nn","ns_*":"ns","oc_*":"oc","or_*":"or","pa_*":"pa","pl_*":"pl","pr_*":"pr","ps_*":"ps","pt_*":"pt","qu_*":"qu","rm_*":"rm","ro_*":"ro","ru_*":"ru","rw_*":"rw","sa_*":"sa","se_*":"se","si_*":"si","sk_*":"sk","sl_*":"sl","sm_*":"sm","sq_*":"sq","sr_*":"sr","sv_*":"sv","sw_*":"sw","sy_*":"sy","ta_*":"ta","te_*":"te","tg_*":"tg","th_*":"th","tk_*":"tk","tn_*":"tn","tr_*":"tr","tt_*":"tt","tz_*":"tz","ug_*":"ug","uk_*":"uk","ur_*":"ur","uz_*":"uz","vi_*":"vi","wo_*":"wo","xh_*":"xh","yo_*":"yo","zh_*":"zh","zu_*":"zu"}).determinePreferredLanguage().fallbackLanguage("en")}]).factory("SettingsService",["$location",function(e){var n={server:"http://"+e.host()+":"+e.port(),browser:"~",dirFirst:!1,browseOrder:"+name",update:8,maxVol:!0,TMDB:!0,chapters:!0,forward:15,backward:15,audelay:.1,subdelay:.1},s={};return t.forEach(n,function(t,e){this.__defineGetter__(e,function(){var n=localStorage.getItem(e);if(null===n)return t;switch(typeof t){case"boolean":return"true"==n&&(n=!0),"false"==n&&(n=!1),n;case"number":var s=parseFloat(n);return s%1==0&&s<1?t:s<0?t:s;default:case"string":return n||t}}),this.__defineSetter__(e,function(t){localStorage.setItem(e,t)})},s),{defaults:n,settings:s}}]).factory("VLC",["$http","SettingsService","$timeout",function(t,e,n){var s=e.settings.server,i=function(e,n){return t({method:"GET",url:e,params:n})};return{sendCommand:function(t){return"object"!=typeof t&&(t={command:t}),i(s+"/requests/status.json",t)},Browse:function(t){return i(s+"/requests/browse.json",{uri:t})},Playlist:function(t){return i(s+"/requests/playlist.json","object"==typeof t?t:t?{command:"pl_empty"}:{})}}}]).filter("seconds",function(){return function(t){return new Date(1970,0,1).setSeconds(t)}}).filter("bytes",function(){return function(t,e){if(isNaN(parseFloat(t))||!isFinite(t))return"-";void 0===e&&(e=1);var n=Math.floor(Math.log(t)/Math.log(1024));return(t/Math.pow(1024,Math.floor(n))).toFixed(e)+" "+["bytes","kB","MB","GB","TB","PB"][n]}}).filter("bitrate",function(){return function(t){return isNaN(parseFloat(t))||!isFinite(t)?"-":parseInt(8e3*t)+" kb/s"}}).run(["VLC",function(t){}]).controller("Settings",["$scope","SettingsService","$window",function(e,n,s){e.settings=n.settings,this.defaults=n.defaults;for(var i=s.document.querySelector("div#settings").getElementsByClassName("toggle"),a=0;a<i.length;a++)i[a].addEventListener("toggle",function(n){var s=t.element(n.target);e.settings[s.attr("id")]=s.hasClass("active")});this.browseOrderOpts=[{id:"+name",value:"+NAME"},{id:"-name",value:"-NAME"},{id:"+modification_time",value:"+MODIFICATION_TIME"},{id:"-modification_time",value:"-MODIFICATION_TIME"},{id:"+creation_time",value:"+CREATION_TIME"},{id:"-creation_time",value:"-CREATION_TIME"},{id:"+access_time",value:"+ACCESS_TIME"},{id:"-access_time",value:"-ACCESS_TIME"}]}]).controller("Playlist",["$scope","VLC",function(n,s){this.load=function(t){return n.loadPlaylist(t)},this.Add=function(){e=1},this.Play=function(e,s){return s&&t.forEach(s,function(t,n){s[n].current=t.id==e}),n.sendCommand({command:"pl_play",id:e}),!0},this.Clear=function(){n.status.state&&"stopped"!=n.status.state&&!confirm("Something is currently playing and will be stopped. Would you continue ?")||this.load(!0)},this.Delete=function(t){this.load({command:"pl_delete",id:t})},this.Pl=function(t){n.sendCommand("pl_"+t)}}]).controller("Browse",["$scope","VLC","SettingsService","$window",function(t,o,r,u){this.load=function(e){o.Browse(e).then(function(e){t.browse=e.data})},t.ordering=function(t){return".."==t.name?0:1},t.nullOrd=function(){return 1},this.load("file://"+u.encodeURIComponent(r.settings.browser)),this.Play=function(n,s){if("s"==this.Ext(n))return t.sendCommand({command:"addsubtitle",val:s});t.sendCommand({command:"in_play",input:n}),e--&&t.loadPlaylist()},this.Queue=function(n){e--?t.loadPlaylist({command:"in_enqueue",input:n}):t.sendCommand({command:"in_enqueue",input:n})},this.Ext=function(t){var e=t.substr(t.lastIndexOf(".")+1).toLowerCase();return n.indexOf(e)>-1?"v":s.indexOf(e)>-1?"a":i.indexOf(e)>-1?"p":a.indexOf(e)>-1&&"s"},this.searchClick=function(){""!=this.search&&(this.search="")},this.isMRL=function(){return/:\/\//.test(this.search)},this.setDefault=function(t){t=u.decodeURIComponent(t).substr(7),confirm("Would you like to make this directory the default one ?\n\n"+t)&&(r.settings.browser=t)}}]).controller("Status",["$scope","VLC","SettingsService","$filter","$interval","$location","$window",function(e,n,s,i,a,o,r){var u,l=this;e.loaded=!0,e.status={},e.error=!1,e.confs=s.settings,e.sendCommand=function(t){n.sendCommand(t).then(function(t){e.status=t.data,e.error=!1},function(t){e.error=t})},e.sendCommand({}),e.focused=!0;var c=function(){if(t.isDefined(u))return!1;u=a(e.sendCommand,1e3*s.settings.update,0,!0,{})};r.addEventListener("blur",function(){a.cancel(u),u=void 0,e.focused=!1}),r.addEventListener("focus",function(){e.sendCommand({}),c(),e.focused=!0}),c(),e.closeModal=function(t){r.document.getElementById(t).classList.remove("active")},this.toggleFullscreen=function(){e.sendCommand("fullscreen")},this.Stop=function(){e.sendCommand("pl_stop")},this.PlayPause=function(){e.sendCommand("playing"==e.status.state?"pl_pause":"pl_play")},this.volIcon=function(t){switch(Math.floor(e.status.volume/2.56/25)){default:case 0:return t?"icon-sound3":"icon-sound4";case 1:case 2:return t?"icon-sound2":"icon-sound3";case 3:case 4:case 5:case 6:case 7:case 8:return t?"icon-sound":"icon-sound2"}},this.Vol=function(t){return(e.status.volume>=256||e.status.volume>230)&&t&&e.confs.maxVol?e.sendCommand({command:"volume",val:256}):e.status.volume<=26&&!t?e.sendCommand({command:"volume",val:0}):e.sendCommand({command:"volume",val:t?e.status.volume+26:e.status.volume-26})};this.pos=new function(){this.timeout=null,this.pos=function(t){return arguments.length&&(e.status.position=parseFloat(t),l.Seek(this.val)),e.status.position},this.__defineGetter__("val",function(){return Math.round(this.pos()*this.len)}),this.__defineGetter__("len",function(){return e.status.length})},this.Seek=function(t){if(!0===t&&(t="+"+s.settings.forward+"s"),!1===t&&(t="-"+s.settings.backward+"s"),void 0===t)return!1;e.sendCommand({command:"seek",val:t})},this.Chapter=function(t){var n=e.status.information.chapters,i=e.status.information.chapter;if(n.length>1&&s.settings.chapters)if(t){if(i<n.length)return e.sendCommand({command:"chapter",val:i+1})}else if(i>0)return e.sendCommand({command:"chapter",val:i-1});return this.pos.val>s.settings.update&&0==t?this.Seek(0):this.Swipe(t)},this.Swipe=function(t){return e.sendCommand(t?"pl_next":"pl_previous")},this.stats={stats:{audio:{decodedaudio:0,playedabuffers:0,lostabuffers:0},video:{decodedvideo:0,displayedpictures:0,lostpictures:0},input:{readbytes:0,inputbitrate:0,demuxreadbytes:0,demuxbitrate:0,demuxcorrupted:0,demuxdiscontinuity:0},output:{sentpackets:0,sentbytes:0,sendbitrate:0}},buildArr:function(){return!!e.status.stats&&(Object.keys(this.stats.audio).forEach(this.populate,this.stats.audio),Object.keys(this.stats.video).forEach(this.populate,this.stats.video),Object.keys(this.stats.input).forEach(this.populateBits,this.stats.input),Object.keys(this.stats.output).forEach(this.populateBits,this.stats.output),!0)},populate:function(t,n){return this[t]=e.status.stats[t]},populateBits:function(t,n){return t.toString().match(/bitrate/)?this[t]=i("bitrate")(e.status.stats[t]):t.toString().match(/bytes/)?this[t]=i("bytes")(e.status.stats[t]):this[t]=e.status.stats[t]}},this.info={keys:["CONTENT_TYPE","title","artist","album","genre","description","SEASON_SYNOPSIS","SUMMARY","date","ACTOR","CHARACTER","GUESTS","DIRECTOR","PRODUCER","WRITTEN_BY","EXECUTIVE_PRODUCER","DIRECTOR_OF_PHOTOGRAPHY","SOUND_ENGINEER","PRODUCTION_DESIGNER","PRODUCTION_STUDIO","RECORDING_LOCATION"],buildArr:function(){var n=e.status;if(this.poster_path=null,!n.information)return!1;n=n.information.category.meta;var s={};return t.forEach(this.keys,function(t,e){if(n[t]){if("CONTENT_TYPE"==t&&n.genre)return s[n[t]]=n.genre;if(("album"!=t||"TV Show"!=n.CONTENT_TYPE&&"Film"!=n.CONTENT_TYPE)&&("SUMMARY"!=t||"Film"!=n.CONTENT_TYPE))return"title"==t&&n.track_number?n.track_total?s[t]="["+n.track_number+"/"+n.track_total+"] "+n[t]:s[t]=n.track_number+". "+n[t]:s[t]="date"==t?i("date")(n[t],"longDate"):n[t]}}),this.infos=s,e.confs.TMDB&&this.buildTMDB(),s},buildTMDB:function(){if(!theMovieDb||!parseVideoName)return!1;if(!e.confs.TMDB)return!1;var n=e.status.information.category.meta.title||e.status.information.category.meta.filename;n=parseVideoName(n);var s=this,a=function(t){console.log("error with TMDB API"),console.log(t)};switch(n.type){case"movie":var o=0,r=function(e){s.infos.title=e.results[0].title,s.TMDBid=e.results[0].id,s.infos.description=e.results[0].overview,s.infos.date=i("date")(e.results[0].release_date,"longDate"),s.poster_path=theMovieDb.common.images_uri+"w500"+e.results[0].poster_path,theMovieDb.movies.getById({id:e.results[0].id},function(t){if(0!=t.genres.length){var e=[];t.genres.forEach(function(t){e.push(t.name)}),s.infos.genre=e.join(", ")}if(0!=t.production_companies.length){var n=[];t.production_companies.forEach(function(t){n.push(t.name+(""!=t.origin_country?" ("+t.origin_country+")":""))}),s.infos.PRODUCTION_STUDIO=n.join(", ")}},a),theMovieDb.movies.getCredits({id:e.results[0].id},function(e){if(0!=e.crew.length){var n={Director:{key:"DIRECTOR",data:[]},Producer:{key:"PRODUCER",data:[]},"Executive Producer":{key:"EXECUTIVE_PRODUCER",data:[]},Writer:{key:"WRITTEN_BY",data:[]},"Director of Photography":{key:"DIRECTOR_OF_PHOTOGRAPHY",data:[]}};e.crew.forEach(function(t){Object.keys(n).includes(t.job)&&n[t.job].data.push(t.name)}),t.forEach(n,function(t){0!=t.data.length&&(s.infos[t.key]=t.data.join(", "))})}if(0!=e.cast.length){var i=[],a=[];e.cast.forEach(function(t){i.push(t.name+" ("+t.character+")"),a.push(t.character+" ("+t.name+")")}),s.infos.ACTOR=i.join(", "),s.infos.CHARACTER=a.join(", ")}},a)};theMovieDb.search.getMovie({query:n.name,year:n.year},function(t){t.total_results>0?r(t):o++<1&&theMovieDb.search.getMovie({query:n.name},function(t){t.total_results>0&&r(t)},a)},a);break;case"series":theMovieDb.search.getTv({query:n.name},function(t){t.total_results>0&&(s.infos.title=t.results[0].name,s.TMDBid=t.results[0].id,s.infos.description=t.results[0].overview,s.poster_path=theMovieDb.common.images_uri+"w500"+t.results[0].poster_path,theMovieDb.tvEpisodes.getById({id:t.results[0].id,season_number:n.season,episode_number:n.episode[0]},function(t){s.infos.title+=" "+t.season_number+"x"+t.episode_number+" - "+t.name,s.infos.SUMMARY=s.infos.description,s.infos.description=t.overview,s.infos.date=i("date")(t.air_date,"longDate"),t.crew.forEach(function(t){switch(t.job){case"Director":s.infos.DIRECTOR=t.name;break;case"Writer":s.infos.WRITTEN_BY=t.name;break;case"Director of Photography":s.infos.DIRECTOR_OF_PHOTOGRAPHY=t.name}}),s.infos.ACTOR=[],t.guest_stars.forEach(function(t){s.infos.ACTOR.push(t.name+" ("+t.character+")")}),s.infos.ACTOR=s.infos.ACTOR.join(", ")},a),theMovieDb.tvSeasons.getById({id:t.results[0].id,season_number:n.season},function(t){s.poster_path=theMovieDb.common.images_uri+"w500"+t.poster_path,s.infos.SEASON_SYNOPSIS=t.overview},a))},a);break;default:case"other":s.poster_path=null}},infos:[],TMDBid:null,poster_path:null},e.$watch("status",function(t,e){l.stats.buildArr(),t.information&&e.information&&t.information.category.meta.filename==e.information.category.meta.filename&&Object.keys(t.information.category).length==Object.keys(e.information.category).length||(l.info.buildArr(),l.streams.buildArr())}),this.streams={buildArr:function(){var n=e.status;if(!n.information)return!1;n=n.information.category,this.streams=[],this.keyTranslations=[["T","Type","Type_","Typ","Tipo"],["C","Codec","Codec_","Códec","Codifica","Kodek"],["L","Language","Langue_","Sprache","Idioma","Lingua","Taal","Linguagem","Wybór_języka"],["Ch","Channels","Canaux_","Canales","Kanäle","Canali","Kanalen","Canais","Kanały"],["B","Bitrate","Tasa_de_bits","Przepływność"]],this.TypeTranslations=[["V","Video","Vidéo","Vídeo","Obraz"],["A","Audio","Audio","Áudio","Dźwięk"],["S","Subtitle","Sous-titres","Sous-titres ","Subtítulo","Untertitel","Sottotitolo","Ondertitel","Legenda","Napisy"]],this.findTranslation=function(e){var n=this.keyTranslations,s=this.TypeTranslations;return t.forEach(e,function(t,i){for(var a=0;a<n.length;a++)if(-1!=n[a].indexOf(i)){if("T"==n[a][0])for(var o=0;o<s.length;o++)-1!=s[o].indexOf(t)&&(e.TT=t,t=s[o][0]);e[n[a][0]]=t}},this),e},t.forEach(n,function(t,e){var n=e.match(/[0-9]+$/);return null!=n&&(this.streams[n[0]]=this.findTranslation(t)),!0},this)},streams:[],select:function(t){e.sendCommand({command:-1==t||"S"==this.streams[t].T?"subtitle_track":"audio_track",val:t})}},this.Rate=function(t){var n=Math.round(100*e.status.rate+100*t)/100;if(n<.25||n>10)return!1;e.sendCommand({command:"rate",val:n})},this.Delay=function(t,n){var i="a"==n?e.status.audiodelay:e.status.subtitledelay,a="a"==n?s.settings.audelay:s.settings.subdelay;e.sendCommand({command:"a"==n?"audiodelay":"subdelay",val:Math.round(1e3*(i+=t?a:-1*a))/1e3})};this.EQ=new function(){t.element(r.document.getElementById("enableEq")).on("toggle",function(n){e.sendCommand({command:"enableeq",val:t.element(this).hasClass("active")?1:0})});var n=this;this.enabled=function(n){return!(!t.isUndefined(e.status.equalizer)&&t.isArray(e.status.equalizer))&&("object"!=typeof e.status.equalizer||void 0===n||e.status.equalizer.hasOwnProperty(n))},this.timeout=null,this.setter=function(t,n){e.sendCommand("object"==typeof t?t:{command:t,val:n})},this.__defineGetter__("preamp",function(){return!!e.status.equalizer&&(this.enabled()?e.status.equalizer.preamp:0)}),this.__defineSetter__("preamp",function(t){if(!this.enabled())return!1;e.status.equalizer.preamp=parseFloat(t),this.setter("preamp",this.preamp)}),this.prsts=[],this.__defineGetter__("presets",function(){return!(!e.status.equalizer||!this.enabled())&&(this.prsts.length<1&&e.status.equalizer.presets&&t.forEach(e.status.equalizer.presets,function(t,e){/[0-9]+/.test(e)&&this.prsts.push({id:e.match(/[0-9]+/)[0],val:t})},this),this.prsts)}),this.__defineSetter__("presets",function(t){this.setter("setpreset",t)}),this._b=["60Hz","170Hz","310Hz","600Hz","1kHz","3kHz","6kHz","12kHz","14kHz","16kHz"],this.bands=[],t.forEach(this._b,function(t,s){this.bands.push({id:s,fq:t,val:function(t){return e.status.equalizer&&n.enabled()?(arguments.length&&n.setter({command:"equalizer",band:s,val:t}),arguments.length?e.status.equalizer.bands['band id="'+s+'"']=t:e.status.equalizer.bands['band id="'+s+'"']):0}})},this)},e.loadPlaylist=function(t){n.Playlist(t).then(function(t){e.playlist=t.data.children})}}]).directive("resize",["$window",function(e){return function(n,s,i){var a=e.document.querySelector(".bar-footer-secondary .btn.control-item.pull-left"),o=e.document.querySelector(".bar-footer-secondary .btn.control-item.pull-right");n.$watch(function(){return{w:e.innerWidth,l:a.clientWidth,r:o.clientWidth}},function(t,e){n.sliderSize=function(){return{width:t.w-46-t.r-t.l+"px"}}},!0),t.element(e).on("resize",function(){n.$apply()}),t.element(e.document).ready(function(){n.$apply()})}}]).directive("fallbackSrc",function(){return{link:function(e,n,s){n.bind("error",function(){t.element(this).attr("src",s.fallbackSrc)})}}});var e=0,n=["asf","avi","divx","drc","dv","f4v","flv","gxf","iso","m1v","m2v","m2t","m2ts","m4v","mkv","mov","mp2","mp4","mpeg","mpeg1","mpeg2","mpeg4","mpg","mts","mtv","mxf","mxg","nuv","ogg","ogm","ogv","ogx","ps","rec","rm","rmvb","ts","vob","wmv","xesc","webm"],s=["3ga","a52","aac","ac3","ape","awb","dts","flac","it","m4a","m4p","mka","mlp","mod","mp1","mp2","mp3","oga","ogg","oma","opus","s3m","spx","thd","tta","wav","wma","wv","xm"],i=["asx","b4s","cue","ifo","m3u","m3u8","pls","ram","sdp","vlc","xspf"],a=["srt","idx","ass","ssa","sup"]}(angular);