var VLCRemote=angular.module("VLCRemote",["ngTouch"]).config(["$compileProvider",function(a){a.debugInfoEnabled(!1)}]).factory("SettingsService",function(){var a={server:"http://"+window.location.hostname+":"+window.location.port,browser:"~",dirFirst:!1,browseOrder:"+name",update:8,maxVol:!0,chapters:!0,forward:15,backward:15,audelay:.1,subdelay:.1},f={};angular.forEach(a,function(a,c){this.__defineGetter__(c,function(){var e=localStorage.getItem(c);if(null===e)return a;switch(typeof a){case "boolean":return"true"==
e&&(e=!0),"false"==e&&(e=!1),e;case "number":return e=parseFloat(e),0===e%1&&1>e||0>e?a:e;default:case "string":return e||a}});this.__defineSetter__(c,function(a){localStorage.setItem(c,a)})},f);return{defaults:a,settings:f}}).factory("VLC",["$http","SettingsService","$timeout",function(a,f,d){var c=f.settings.server,e=function(c,b){return a({method:"GET",url:c,params:b})};return{sendCommand:function(a){"object"!=typeof a&&(a={command:a});return e(c+"/requests/status.json",a)},Browse:function(a){return e(c+
"/requests/browse.json",{uri:a})},Playlist:function(a){return e(c+"/requests/playlist.json","object"==typeof a?a:a?{command:"pl_empty"}:{})}}}]).filter("seconds",[function(){return function(a){return(new Date(1970,0,1)).setSeconds(a)}}]).run(["VLC",function(a){}]).controller("Headers",["$scope",function(a){a.isIOs=function(){return RegExp("(iPad|iPhone|iPod)","g").test(navigator.userAgent)}}]).controller("Settings",["$scope","SettingsService",function(a,f){a.settings=f.settings;this.defaults=f.defaults;
for(var d=document.querySelector("div#settings").getElementsByClassName("toggle"),c=0;c<d.length;c++)d[c].addEventListener("toggle",function(c){c=angular.element(c.target);a.settings[c.attr("id")]=c.hasClass("active")});this.browseOrderOpts=[{id:"+name",value:"\u2193 Filename"},{id:"-name",value:"\u2191 Filename"},{id:"+modification_time",value:"\u2193 Last Modified"},{id:"-modification_time",value:"\u2191 Last Modified"},{id:"+creation_time",value:"\u2193 Creation date"},{id:"-creation_time",value:"\u2191 Creation date"},
{id:"+access_time",value:"\u2193 Last accessed"},{id:"-access_time",value:"\u2191 Last accessed"}]}]).controller("Playlist",["$scope","VLC",function(a,f){this.load=function(d){return a.loadPlaylist(d)};this.Add=function(){reloadPlaylist=1};this.Play=function(d,c){c&&angular.forEach(c,function(a,f){c[f].current=a.id==d?!0:!1});a.sendCommand({command:"pl_play",id:d});return!0};this.Clear=function(){a.status.state&&"stopped"!=a.status.state&&!confirm("Something is currently playing and will be stopped. Would you continue ?")||
this.load(!0)};this.Delete=function(a){this.load({command:"pl_delete",id:a})}}]).controller("Browse",["$scope","VLC","SettingsService",function(a,f,d){this.load=function(c){f.Browse(c).then(function(c){a.browse=c.data})};a.ordering=function(a){return".."==a.name?0:1};this.load("file://"+d.settings.browser);this.Play=function(c){if("s"==this.Ext(c))return a.sendCommand({command:"addsubtitle",val:c});a.sendCommand({command:"in_play",input:c});reloadPlaylist--&&a.loadPlaylist()};this.Queue=function(c){reloadPlaylist--?
a.loadPlaylist({command:"in_enqueue",input:c}):a.sendCommand({command:"in_enqueue",input:c})};this.Ext=function(a){a=a.substr(a.lastIndexOf(".")+1).toLowerCase();return-1<video_types.indexOf(a)?"v":-1<audio_types.indexOf(a)?"a":-1<playlist_types.indexOf(a)?"p":-1<subtitle_types.indexOf(a)?"s":!1};this.searchClick=function(){""!=this.search&&(this.search="")}}]).controller("Status",["$scope","VLC","SettingsService","$filter","$interval",function(a,f,d,c,e){var g=this;a.status={};a.error=!1;a.confs=
d.settings;a.sendCommand=function(b){f.sendCommand(b).then(function(b){a.status=b.data;a.error=!1},function(b){a.error=b})};a.sendCommand({});this.updateInterval=e(a.sendCommand,1E3*d.settings.update,0,!0,{});a.closeModal=function(a){document.getElementById(a).classList.remove("active")};this.toggleFullscreen=function(){a.sendCommand("fullscreen")};this.Stop=function(){a.sendCommand("pl_stop")};this.PlayPause=function(){a.sendCommand("playing"==a.status.state?"pl_pause":"pl_play")};this.volIcon=function(b){switch(Math.floor(a.status.volume/
2.56/25)){default:case 0:return b?"icon-sound3":"icon-sound4";case 1:case 2:return b?"icon-sound2":"icon-sound3";case 3:case 4:case 5:case 6:case 7:case 8:return b?"icon-sound":"icon-sound2"}};this.Vol=function(b){return(256<=a.status.volume||230<a.status.volume)&&b&&a.confs.maxVol?a.sendCommand({command:"volume",val:256}):26>=a.status.volume&&!b?a.sendCommand({command:"volume",val:0}):a.sendCommand({command:"volume",val:b?a.status.volume+26:a.status.volume-26})};this.sliderSize=function(){var a=
window.innerWidth-46-document.querySelector(".bar-footer-secondary .btn.control-item.pull-left").clientWidth-document.querySelector(".bar-footer-secondary .btn.control-item.pull-right").clientWidth;angular.element(document.querySelector(".bar-footer-secondary input[type=range]")).css("width",a+"px")};angular.element(window).on("resize",function(){g.sliderSize()});angular.element(document).ready(function(){g.sliderSize()});this.pos=new function(){this.timeout=null;this.__defineGetter__("pos",function(){return a.status.position});
this.__defineSetter__("pos",function(b){a.status.position=parseFloat(b);this.timeout&&clearTimeout(this.timeout);var c=this;this.timeout=setTimeout(function(){g.Seek(c.val)},100)});this.__defineGetter__("val",function(){return Math.round(this.pos*this.len)});this.__defineGetter__("len",function(){return a.status.length})};this.Seek=function(b){!0===b&&(b="+"+d.settings.forward+"s");!1===b&&(b="-"+d.settings.backward+"s");if("undefined"==typeof b)return!1;a.sendCommand({command:"seek",val:b})};this.Chapter=
function(b){var c=a.status.information.chapters,e=a.status.information.chapter;if(1<c.length&&d.settings.chapters)if(b){if(e<c.length)return a.sendCommand({command:"chapter",val:e+1})}else if(0<e)return a.sendCommand({command:"chapter",val:e-1});return this.pos.val>d.settings.update&&0==b?this.Seek(0):this.Swipe(b)};this.Swipe=function(b){return a.sendCommand(b?"pl_next":"pl_previous")};this.info={keys:{CONTENT_TYPE:"Type",title:"Title",artist:"Artist",album:"Album",genre:"Genre",description:"Synopsis",
SEASON_SYNOPSIS:"Season's Plot",SUMMARY:"Show's Plot",date:"Release Date",ACTOR:"Actors",CHARACTER:"Characters",GUESTS:"Guests",DIRECTOR:"Director",PRODUCER:"Producer",WRITTEN_BY:"Written by",EXECUTIVE_PRODUCER:"Executive Producer(s)",DIRECTOR_OF_PHOTOGRAPHY:"Director of Photography",SOUND_ENGINEER:"Sound Engineers",PRODUCTION_DESIGNER:"Production Designer",PRODUCTION_STUDIO:"Production Studio",RECORDING_LOCATION:"Recording Location"},buildArr:function(){var b=a.status;if(!b.information)return!1;
var b=b.information.category.meta,e=[];angular.forEach(this.keys,function(a,d){if(b[d]){if("CONTENT_TYPE"==d&&b.genre)return e.push({key:b[d],val:b.genre});if("album"!=d||"TV Show"!=b.CONTENT_TYPE&&"Film"!=b.CONTENT_TYPE)if("SUMMARY"!=d||"Film"!=b.CONTENT_TYPE)return"title"==d&&b.track_number?b.track_total?e.push({key:a,val:"["+b.track_number+"/"+b.track_total+"] "+b[d]}):e.push({key:a,val:b.track_number+". "+b[d]}):"date"==d?e.push({key:a,val:c("date")(b[d],"longDate")}):e.push({key:a,val:b[d]})}});
return this.infos=e},infos:[]};a.$watch("status",function(a,c){a.information&&c.information&&a.information.category.meta.filename==c.information.category.meta.filename||(g.info.buildArr(),g.streams.buildArr())});this.streams={buildArr:function(){var b=a.status;if(!b.information)return!1;var b=b.information.category,c=0;for(this.streams=[];b.hasOwnProperty("Stream "+c);){var d=b["Stream "+c];this.streams[c++]=d}},streams:[],select:function(b){a.sendCommand({command:-1==b||"Subtitle"==this.streams[b].Type?
"subtitle_track":"audio_track",val:b})}};this.Delay=function(b,c){var e="a"==c?d.settings.audelay:d.settings.subdelay;a.sendCommand({command:"a"==c?"audiodelay":"subdelay",val:Math.round(1E3*(("a"==c?a.status.audiodelay:a.status.subtitledelay)+(b?e:-1*e)))/1E3})};a.loadPlaylist=function(b){f.Playlist(b).then(function(b){a.playlist=b.data.children})}}]).directive("fallbackSrc",function(){return{link:function(a,f,d){f.bind("error",function(){angular.element(this).attr("src",d.fallbackSrc)})}}}),reloadPlaylist=
0,video_types="asf avi divx drc dv f4v flv gxf iso m1v m2v m2t m2ts m4v mkv mov mp2 mp4 mpeg mpeg1 mpeg2 mpeg4 mpg mts mtv mxf mxg nuv ogg ogm ogv ogx ps rec rm rmvb ts vob wmv xesc".split(" "),audio_types="3ga a52 aac ac3 ape awb dts flac it m4a m4p mka mlp mod mp1 mp2 mp3 oga ogg oma s3m spx thd tta wav wma wv xm".split(" "),playlist_types="asx b4s cue ifo m3u m3u8 pls ram rar sdp vlc xspf".split(" "),subtitle_types=["srt","idx","ass","ssa","sup"];